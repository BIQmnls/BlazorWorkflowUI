@using Microsoft.AspNetCore.Components
@using BlazorWorkflowUI.Models

<MudPaper Class="mt-2 pa-4">
    <MudTimeline>
        <MudTimelineItem Icon="@Icons.Material.Filled.PlayArrow">
            <ChildContent>
                <MudText>Trigger: @Workflow.Trigger.ActivityType</MudText>
            </ChildContent>
        </MudTimelineItem>
        @foreach (var step in Workflow.Steps)
        {
            <MudTimelineItem Icon="@Icons.Material.Filled.ChevronRight">
                <ChildContent>
                    <MudText Typo="Typo.caption">Condition: @step.Condition</MudText>
                    @if (step.ElseActivityType != null)
                    {
                        <MudTimeline Dense="true" Class="ml-6">
                            <MudTimelineItem Icon="@Icons.Material.Filled.Check">
                                <ChildContent>
                                    <MudText>@step.ActivityType</MudText>
                                    @if (step.ActivityType == "WaitForDocuments")
                                    {
                                        <MudText Typo="Typo.caption">Wait: @step.DelaySeconds s</MudText>
                                    }
                                </ChildContent>
                            </MudTimelineItem>
                            <MudTimelineItem Icon="@Icons.Material.Filled.Close">
                                <ChildContent>
                                    <MudText>@step.ElseActivityType</MudText>
                                    @if (step.ElseActivityType == "WaitForDocuments")
                                    {
                                        <MudText Typo="Typo.caption">Wait: @step.ElseDelaySeconds s</MudText>
                                    }
                                </ChildContent>
                            </MudTimelineItem>
                        </MudTimeline>
                    }
                    else
                    {
                        <MudText>@step.ActivityType</MudText>
                        @if (step.ActivityType == "WaitForDocuments")
                        {
                            <MudText Typo="Typo.caption">Wait: @step.DelaySeconds s</MudText>
                        }
                    }
                </ChildContent>
            </MudTimelineItem>
        }
    </MudTimeline>
</MudPaper>

@code {
    [Parameter]
    public WorkflowModel Workflow { get; set; } = new();
}
